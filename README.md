# Drone Maps Viewer

A web-based viewer for displaying orthographic maps and 3D models generated by webODM. This lightweight, static website provides an intuitive interface for visualizing drone imagery processing outputs.

![Drone Maps](https://img.shields.io/badge/webODM-compatible-blue)
![License](https://img.shields.io/badge/license-MIT-green)

## Features

### ðŸ—ºï¸ Orthographic Map Viewer
- Display georeferenced orthophotos from webODM
- Support for tile servers (XYZ tiles)
- Interactive map navigation with zoom and pan
- Built on Leaflet.js for reliable mapping

### ðŸ”ï¸ 3D Model Viewer
- View 3D textured meshes and point clouds
- Support for OBJ, PLY, and LAS/LAZ formats
- Interactive 3D navigation (rotate, pan, zoom)
- Built on Three.js for WebGL rendering

### âš™ï¸ Configuration
- Save webODM connection settings
- Configurable API endpoints
- Local storage for user preferences

## Quick Start

### Running Locally

1. Clone this repository:
   ```bash
   git clone https://github.com/sithor/drone-maps.git
   cd drone-maps
   ```

2. Serve the files using any HTTP server:
   ```bash
   # Using Python 3
   python -m http.server 8000
   
   # Using Python 2
   python -m SimpleHTTPServer 8000
   
   # Using Node.js (http-server)
   npx http-server -p 8000
   
   # Using PHP
   php -S localhost:8000
   ```

3. Open your browser and navigate to:
   ```
   http://localhost:8000
   ```

### Deployment

This is a static website and can be hosted on:
- GitHub Pages
- Netlify
- Vercel
- AWS S3 + CloudFront
- Any static web hosting service

## Usage Guide

### Loading Orthographic Maps

1. Navigate to the **Orthographic Maps** tab
2. Enter your webODM tile server URL in the format:
   ```
   https://[webodm-server]/api/projects/{project_id}/tasks/{task_id}/orthophoto/tiles/{z}/{x}/{y}.png
   ```
3. Click **Load Tiles** to display the map
4. Use mouse controls to navigate:
   - Click and drag to pan
   - Scroll to zoom
   - Double-click to zoom in

### Loading 3D Models

1. Navigate to the **3D Models** tab
2. Either:
   - Enter a URL to a model file (OBJ, PLY, LAS)
   - Upload a local model file
3. Click **Load Model**
4. Use mouse controls to interact:
   - Left-click and drag to rotate
   - Right-click and drag to pan
   - Scroll to zoom

### Connecting to webODM

#### Prerequisites
- A running webODM instance
- Completed processing tasks with orthophotos or 3D models

#### Steps

1. Go to the **Setup** tab
2. Enter your webODM base URL (e.g., `https://your-server.com`)
3. (Optional) Enter your API token for authenticated access
4. Click **Save Configuration**

#### Getting Tile URLs from webODM

1. Log in to your webODM instance
2. Navigate to your project and task
3. Open the orthophoto viewer
4. Copy the tile endpoint URL from the network inspector or webODM API documentation

#### Downloading Models from webODM

1. Log in to your webODM instance
2. Navigate to your project and task
3. Click on **Download Assets**
4. Download one of:
   - Textured Model (OBJ + textures)
   - Point Cloud (LAS/LAZ or PLY)
5. Upload the file to the 3D Models viewer

## CORS Configuration

If you're loading data from a remote webODM instance, you need to configure CORS:

### On the webODM Server

Add the following to your webODM configuration:

```python
# In settings.py or your webODM configuration
CORS_ALLOWED_ORIGINS = [
    "https://your-viewer-domain.com",
    "http://localhost:8000",  # For local development
]
```

### Alternative: Same-Domain Hosting

Host this viewer on the same domain as your webODM instance to avoid CORS issues:
- Deploy at `https://your-webodm.com/viewer/`
- Access webODM API at `https://your-webodm.com/api/`

## Project Structure

```
drone-maps/
â”œâ”€â”€ index.html          # Main HTML page
â”œâ”€â”€ css/
â”‚   â””â”€â”€ style.css       # Styles and layout
â”œâ”€â”€ js/
â”‚   â””â”€â”€ app.js          # Application logic
â””â”€â”€ README.md           # Documentation
```

## Technology Stack

- **Leaflet.js** (v1.9.4) - Interactive maps
- **Three.js** (v0.159.0) - 3D graphics and WebGL rendering
- **Vanilla JavaScript** - No framework dependencies
- **CSS3** - Modern, responsive styling

## Browser Support

- Chrome/Edge (latest)
- Firefox (latest)
- Safari (latest)
- Opera (latest)

WebGL support is required for 3D model viewing.

## Extending the Viewer

### Adding Model Loaders

To support actual OBJ, PLY, or LAS file loading, you'll need to integrate Three.js loaders:

```javascript
// Example: Loading OBJ files
import { OBJLoader } from 'three/examples/jsm/loaders/OBJLoader.js';

const loader = new OBJLoader();
loader.load(url, (object) => {
    scene.add(object);
});
```

### Integrating webODM API

For direct API integration:

```javascript
// Example: Fetching task details
async function getTaskInfo(projectId, taskId) {
    const response = await fetch(
        `${webodmUrl}/api/projects/${projectId}/tasks/${taskId}/`,
        {
            headers: {
                'Authorization': `Token ${apiToken}`
            }
        }
    );
    return await response.json();
}
```

## Sample Data

To test the viewer without webODM:

1. Visit [OpenDroneMap Sample Datasets](https://github.com/OpenDroneMap/ODM/wiki/Sample-Datasets)
2. Download sample imagery
3. Process through [webODM](https://www.opendronemap.org/webodm/)
4. Use the outputs with this viewer

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## License

MIT License - feel free to use this project for any purpose.

## Related Projects

- [webODM](https://www.opendronemap.org/webodm/) - Web interface for OpenDroneMap
- [OpenDroneMap](https://www.opendronemap.org/) - Open source drone mapping software
- [Leaflet](https://leafletjs.com/) - Mobile-friendly interactive maps
- [Three.js](https://threejs.org/) - JavaScript 3D library

## Support

For issues and questions:
- Open an issue on GitHub
- Check webODM documentation for API details
- Visit OpenDroneMap community forum

## Acknowledgments

Built for the OpenDroneMap and webODM community.